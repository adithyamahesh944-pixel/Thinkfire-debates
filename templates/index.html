<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ThinkFire üî•</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:ital,wght@0,400;0,500;1,400&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #06060f;
    --surface: #0e0e1f;
    --surface2: #15152b;
    --border: #1e1e3a;
    --red: #ef4444;
    --orange: #f97316;
    --purple: #7c3aed;
    --text: #e8e8f0;
    --muted: #6b6b8a;
    --glow: rgba(239,68,68,0.15);
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  /* Animated background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 60% 40% at 10% 20%, rgba(239,68,68,0.06) 0%, transparent 60%),
      radial-gradient(ellipse 50% 60% at 90% 80%, rgba(124,58,237,0.07) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  /* TOP BAR */
  .topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 24px;
    border-bottom: 1px solid var(--border);
    background: rgba(6,6,15,0.9);
    backdrop-filter: blur(12px);
    position: relative;
    z-index: 10;
    flex-shrink: 0;
  }

  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    letter-spacing: 3px;
    background: linear-gradient(135deg, #ef4444, #f97316);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: none;
  }

  .logo span { color: #fff; -webkit-text-fill-color: #fff; opacity: 0.3; font-size: 14px; letter-spacing: 1px; vertical-align: middle; margin-left: 8px; font-family: 'DM Mono', monospace; }

  .status-badges {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .badge {
    font-size: 10px;
    padding: 3px 10px;
    border-radius: 20px;
    letter-spacing: 1px;
    font-weight: 500;
    text-transform: uppercase;
  }
  .badge.live { background: rgba(239,68,68,0.15); border: 1px solid rgba(239,68,68,0.4); color: #ef4444; }
  .badge.pdf { background: rgba(124,58,237,0.15); border: 1px solid rgba(124,58,237,0.4); color: #a78bfa; }
  .badge.voice { background: rgba(249,115,22,0.15); border: 1px solid rgba(249,115,22,0.4); color: #f97316; }

  .pulse { width: 6px; height: 6px; background: #ef4444; border-radius: 50%; display: inline-block; margin-right: 4px; animation: pulse 1.5s infinite; }
  @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.4;transform:scale(0.7)} }

  /* MAIN LAYOUT */
  .main {
    display: flex;
    flex: 1;
    overflow: hidden;
    position: relative;
    z-index: 1;
  }

  /* SIDEBAR */
  .sidebar {
    width: 260px;
    background: var(--surface);
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    overflow-y: auto;
  }

  .sidebar-section {
    padding: 16px;
    border-bottom: 1px solid var(--border);
  }

  .sidebar-label {
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--muted);
    margin-bottom: 10px;
  }

  .profile-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px;
  }

  .profile-name {
    font-family: 'Instrument Serif', serif;
    font-size: 18px;
    color: #fff;
    margin-bottom: 2px;
  }

  .profile-sub {
    font-size: 10px;
    color: var(--muted);
  }

  .interest-tag {
    display: inline-block;
    margin-top: 8px;
    background: rgba(239,68,68,0.1);
    border: 1px solid rgba(239,68,68,0.3);
    color: #f87171;
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 20px;
  }

  .intensity-bar {
    margin-top: 10px;
  }
  .intensity-label { font-size: 10px; color: var(--muted); margin-bottom: 6px; }
  .intensity-track {
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }
  .intensity-fill {
    height: 100%;
    width: 75%;
    background: linear-gradient(90deg, #ef4444, #f97316);
    border-radius: 2px;
  }
  .intensity-labels { display: flex; justify-content: space-between; font-size: 9px; color: var(--muted); margin-top: 4px; }

  .pdf-box {
    background: rgba(124,58,237,0.08);
    border: 1px dashed rgba(124,58,237,0.3);
    border-radius: 8px;
    padding: 12px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
  }
  .pdf-box:hover { background: rgba(124,58,237,0.15); border-style: solid; }
  .pdf-icon { font-size: 22px; margin-bottom: 4px; }
  .pdf-text { font-size: 10px; color: var(--muted); }
  .pdf-loaded { font-size: 10px; color: #a78bfa; }

  .scorecard {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px;
  }

  .score-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .score-label { font-size: 10px; color: var(--muted); }

  .score-val {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 20px;
    color: #f97316;
  }

  .mini-bars { display: flex; flex-direction: column; gap: 6px; }
  .mini-bar-row { display: flex; align-items: center; gap: 8px; }
  .mini-bar-name { font-size: 9px; color: var(--muted); width: 70px; }
  .mini-bar-track { flex: 1; height: 3px; background: var(--border); border-radius: 2px; overflow: hidden; }
  .mini-bar-fill { height: 100%; border-radius: 2px; }
  .bar-logic { background: #ef4444; width: 80%; }
  .bar-clarity { background: #f97316; width: 65%; }
  .bar-evidence { background: #a78bfa; width: 50%; }

  .eval-btn {
    width: 100%;
    margin-top: 10px;
    padding: 8px;
    background: linear-gradient(135deg, #ef4444, #7c3aed);
    border: none;
    border-radius: 8px;
    color: white;
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 1px;
    cursor: pointer;
    text-transform: uppercase;
    transition: opacity 0.2s;
  }
  .eval-btn:hover { opacity: 0.85; }

  /* CHAT AREA */
  .chat-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .chat-header {
    padding: 14px 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
  }

  .topic-pill {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 4px 14px;
    font-size: 11px;
    color: var(--muted);
  }

  .topic-pill strong { color: #f87171; }

  .mode-indicator {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 10px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .flame { animation: flicker 0.8s infinite alternate; display: inline-block; }
  @keyframes flicker { from{transform:scale(1) rotate(-2deg)} to{transform:scale(1.1) rotate(2deg)} }

  /* MESSAGES */
  .messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
    scroll-behavior: smooth;
  }

  .messages::-webkit-scrollbar { width: 4px; }
  .messages::-webkit-scrollbar-track { background: transparent; }
  .messages::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

  .msg {
    display: flex;
    gap: 12px;
    max-width: 80%;
    animation: fadeUp 0.3s ease;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .msg.user { align-self: flex-end; flex-direction: row-reverse; }
  .msg.ai   { align-self: flex-start; }

  .avatar {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
  }

  .avatar.ai-av {
    background: linear-gradient(135deg, #ef4444, #7c3aed);
    box-shadow: 0 0 14px rgba(239,68,68,0.35);
  }

  .avatar.user-av {
    background: var(--surface2);
    border: 1px solid var(--border);
  }

  .bubble {
    padding: 12px 16px;
    border-radius: 14px;
    font-size: 13px;
    line-height: 1.65;
  }

  .msg.ai .bubble {
    background: var(--surface);
    border: 1px solid var(--border);
    border-top-left-radius: 4px;
  }

  .msg.user .bubble {
    background: rgba(239,68,68,0.1);
    border: 1px solid rgba(239,68,68,0.25);
    border-top-right-radius: 4px;
    color: #fecaca;
  }

  .bubble .bold-q {
    color: #f97316;
    font-weight: 500;
    display: block;
    margin-top: 8px;
    font-style: italic;
  }

  .bubble .analogy-tag {
    display: inline-block;
    background: rgba(249,115,22,0.1);
    border: 1px solid rgba(249,115,22,0.25);
    color: #f97316;
    font-size: 9px;
    padding: 1px 6px;
    border-radius: 4px;
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .voice-chip {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-top: 8px;
    font-size: 9px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .voice-waves {
    display: flex;
    gap: 2px;
    align-items: center;
  }

  .wave {
    width: 2px;
    background: #ef4444;
    border-radius: 1px;
    animation: wave 1s ease-in-out infinite;
  }
  .wave:nth-child(1){ height:6px; animation-delay:0s; }
  .wave:nth-child(2){ height:10px; animation-delay:0.1s; }
  .wave:nth-child(3){ height:14px; animation-delay:0.2s; }
  .wave:nth-child(4){ height:10px; animation-delay:0.3s; }
  .wave:nth-child(5){ height:6px; animation-delay:0.4s; }
  @keyframes wave { 0%,100%{transform:scaleY(0.5)} 50%{transform:scaleY(1)} }

  /* TYPING INDICATOR */
  .typing {
    display: flex;
    gap: 4px;
    align-items: center;
    padding: 12px 16px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    border-top-left-radius: 4px;
    width: fit-content;
  }

  .dot {
    width: 6px; height: 6px;
    background: var(--muted);
    border-radius: 50%;
    animation: bounce 1.2s infinite;
  }
  .dot:nth-child(2){ animation-delay:0.2s }
  .dot:nth-child(3){ animation-delay:0.4s }
  @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-5px)} }

  /* INPUT */
  .input-area {
    padding: 14px 24px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 10px;
    align-items: flex-end;
    flex-shrink: 0;
    background: rgba(6,6,15,0.7);
    backdrop-filter: blur(8px);
  }

  .input-wrap {
    flex: 1;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    display: flex;
    align-items: center;
    padding: 10px 14px;
    gap: 8px;
    transition: border-color 0.2s;
  }

  .input-wrap:focus-within {
    border-color: rgba(239,68,68,0.5);
    box-shadow: 0 0 0 3px rgba(239,68,68,0.05);
  }

  .input-wrap textarea {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 13px;
    resize: none;
    max-height: 100px;
    line-height: 1.5;
  }

  .input-wrap textarea::placeholder { color: var(--muted); }

  .mic-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--muted);
    font-size: 16px;
    padding: 4px;
    transition: color 0.2s;
    display: flex;
    align-items: center;
  }
  .mic-btn:hover { color: #ef4444; }
  .mic-btn.recording { color: #ef4444; animation: pulse 1s infinite; }

  .send-btn {
    background: linear-gradient(135deg, #ef4444, #7c3aed);
    border: none;
    border-radius: 10px;
    width: 42px;
    height: 42px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    transition: transform 0.15s, opacity 0.15s;
    flex-shrink: 0;
  }
  .send-btn:hover { transform: scale(1.05); }
  .send-btn:active { transform: scale(0.95); }

  /* SCORECARD MODAL */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(6,6,15,0.85);
    backdrop-filter: blur(8px);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.2s ease;
  }

  @keyframes fadeIn { from{opacity:0} to{opacity:1} }

  .modal {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 32px;
    width: 420px;
    max-width: 90vw;
    position: relative;
    animation: slideUp 0.3s ease;
  }

  @keyframes slideUp { from{transform:translateY(20px);opacity:0} to{transform:translateY(0);opacity:1} }

  .modal-close {
    position: absolute;
    top: 16px; right: 16px;
    background: none; border: none;
    color: var(--muted); font-size: 18px;
    cursor: pointer;
    width: 28px; height: 28px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 6px;
  }
  .modal-close:hover { background: var(--surface2); color: var(--text); }

  .modal-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 32px;
    letter-spacing: 3px;
    background: linear-gradient(135deg, #ef4444, #f97316);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 4px;
  }

  .modal-sub { font-size: 11px; color: var(--muted); margin-bottom: 24px; }

  .big-score {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 24px;
  }

  .big-score-num {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 80px;
    line-height: 1;
    background: linear-gradient(135deg, #ef4444, #f97316);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .big-score-denom {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    color: var(--muted);
    align-self: flex-end;
    margin-bottom: 12px;
  }

  .score-breakdown { display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }

  .breakdown-row { display: flex; align-items: center; gap: 10px; }
  .breakdown-name { font-size: 11px; color: var(--muted); width: 100px; }
  .breakdown-track { flex: 1; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
  .breakdown-fill { height: 100%; border-radius: 3px; transition: width 0.8s ease; }
  .fill-red { background: linear-gradient(90deg, #ef4444, #f97316); }
  .fill-purple { background: linear-gradient(90deg, #7c3aed, #a78bfa); }
  .fill-orange { background: linear-gradient(90deg, #f97316, #fbbf24); }
  .breakdown-score { font-size: 11px; color: var(--text); font-weight: 500; width: 30px; text-align: right; }

  .fallacy-box {
    background: rgba(239,68,68,0.06);
    border: 1px solid rgba(239,68,68,0.2);
    border-radius: 10px;
    padding: 12px;
    margin-bottom: 16px;
  }

  .fallacy-title { font-size: 9px; text-transform: uppercase; letter-spacing: 2px; color: #f87171; margin-bottom: 8px; }
  .fallacy-item { font-size: 11px; color: var(--muted); margin-bottom: 4px; display: flex; align-items: flex-start; gap: 6px; }
  .fallacy-item::before { content: '‚Üí'; color: #ef4444; flex-shrink: 0; }

  .hidden { display: none !important; }
</style>
</head>
<body>

<!-- TOPBAR -->
<div class="topbar">
  <div class="logo">ThinkFire <span>ARENA</span></div>
  <div class="status-badges">
    <span class="badge live"><span class="pulse"></span>Live</span>
    <span class="badge pdf">üìÑ Physics.pdf</span>
    <span class="badge voice">üîä Voice On</span>
  </div>
</div>

<!-- MAIN -->
<div class="main">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-label">Your Profile</div>
      <div class="profile-card">
        <div class="profile-name">Arjun S.</div>
        <div class="profile-sub">Session #4 ¬∑ 12 min</div>
        <div class="interest-tag">‚ö° Cricket Analogies</div>
        <div class="intensity-bar">
          <div class="intensity-label">Intensity</div>
          <div class="intensity-track"><div class="intensity-fill"></div></div>
          <div class="intensity-labels"><span>Gentle</span><span>Brutal üíÄ</span></div>
        </div>
      </div>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-label">Syllabus</div>
      <div class="pdf-box">
        <div class="pdf-icon">üìÑ</div>
        <div class="pdf-loaded">Physics Ch.3 ‚Äî Loaded</div>
        <div class="pdf-text" style="margin-top:2px">47 pages ¬∑ Newton's Laws</div>
      </div>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-label">Logic Scorecard</div>
      <div class="scorecard">
        <div class="score-row">
          <span class="score-label">Current Score</span>
          <span class="score-val">7.2</span>
        </div>
        <div class="mini-bars">
          <div class="mini-bar-row">
            <span class="mini-bar-name">Logic</span>
            <div class="mini-bar-track"><div class="mini-bar-fill bar-logic"></div></div>
            <span style="font-size:9px;color:var(--muted);width:24px;text-align:right">8</span>
          </div>
          <div class="mini-bar-row">
            <span class="mini-bar-name">Clarity</span>
            <div class="mini-bar-track"><div class="mini-bar-fill bar-clarity"></div></div>
            <span style="font-size:9px;color:var(--muted);width:24px;text-align:right">6.5</span>
          </div>
          <div class="mini-bar-row">
            <span class="mini-bar-name">Evidence</span>
            <div class="mini-bar-track"><div class="mini-bar-fill bar-evidence"></div></div>
            <span style="font-size:9px;color:var(--muted);width:24px;text-align:right">5</span>
          </div>
        </div>
        <button class="eval-btn" onclick="showModal()">üìä Final Evaluation</button>
      </div>
    </div>
  </div>

  <!-- CHAT AREA -->
  <div class="chat-area">
    <div class="chat-header">
      <div class="topic-pill">Topic: <strong>Newton's Laws of Motion</strong></div>
      <div class="mode-indicator"><span class="flame">üî•</span> Socratic Mode ¬∑ Aggressive</div>
    </div>

    <div class="messages" id="messages">

      <!-- AI Message 1 -->
      <div class="msg ai">
        <div class="avatar ai-av">üî•</div>
        <div>
          <div class="bubble">
            <span class="analogy-tag">üèè Cricket Analogy</span>
            Welcome, Arjun. Today we're tackling Newton's Laws. Let me frame this your way ‚Äî think of Newton's First Law like a cricket ball that refuses to change its path unless a bowler applies force. It just keeps going. Forever. <span class="bold-q">But here's my first challenge ‚Äî if that's true, why does every ball you've ever seen eventually stop? Did Newton get it wrong?</span>
          </div>
          <div class="voice-chip">
            <div class="voice-waves"><div class="wave"></div><div class="wave"></div><div class="wave"></div><div class="wave"></div><div class="wave"></div></div>
            Speaking...
          </div>
        </div>
      </div>

      <!-- User Message 1 -->
      <div class="msg user">
        <div class="avatar user-av">A</div>
        <div class="bubble">
          The ball stops because of friction and air resistance. That's not a contradiction ‚Äî Newton's law assumes an ideal environment with no external forces.
        </div>
      </div>

      <!-- AI Message 2 -->
      <div class="msg ai">
        <div class="avatar ai-av">üî•</div>
        <div>
          <div class="bubble">
            Interesting. You've invoked friction and air resistance ‚Äî but notice what you just did: you called them "external forces." So by your own logic, they ARE forces acting on the ball. Which means the ball is never truly isolated. <span class="bold-q">So when exactly does Newton's First Law actually apply in the real world, Arjun? Name me one real situation ‚Äî not a textbook vacuum ‚Äî where an object truly experiences zero net force.</span>
          </div>
        </div>
      </div>

      <!-- User Message 2 -->
      <div class="msg user">
        <div class="avatar user-av">A</div>
        <div class="bubble">
          Uh... maybe a satellite in space? It keeps orbiting without stopping.
        </div>
      </div>

      <!-- AI Message 3 with typing follow -->
      <div class="msg ai">
        <div class="avatar ai-av">üî•</div>
        <div>
          <div class="bubble">
            Close ‚Äî but a satellite is constantly being <em>pulled</em> by Earth's gravity. It's not experiencing zero force; it's in free fall perpetually missing the Earth. That's actually Newton's Second Law at play, not the First. You're confusing uniform circular motion with inertia. <span class="bold-q">Your argument is slipping ‚Äî can you recover? What would a truly force-free object actually look like, and does it exist?</span>
          </div>
        </div>
      </div>

      <!-- Typing indicator -->
      <div class="msg ai" id="typing-row" style="display:none">
        <div class="avatar ai-av">üî•</div>
        <div class="typing">
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>
      </div>

    </div>

    <!-- INPUT -->
    <div class="input-area">
      <div class="input-wrap">
        <button class="mic-btn" id="micBtn" onclick="toggleMic()" title="Hold to speak">üéôÔ∏è</button>
        <textarea id="userInput" rows="1" placeholder="State your claim... defend your logic." onkeydown="handleKey(event)" oninput="autoResize(this)"></textarea>
      </div>
      <button class="send-btn" onclick="sendMessage()">‚û§</button>
    </div>
  </div>
</div>

<!-- SCORECARD MODAL -->
<div class="modal-overlay hidden" id="modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <div class="modal-title">Logic Report</div>
    <div class="modal-sub">Session #4 ¬∑ Newton's Laws ¬∑ 12 exchanges</div>

    <div class="big-score">
      <div class="big-score-num">7</div>
      <div class="big-score-denom">/10</div>
    </div>

    <div class="score-breakdown">
      <div class="breakdown-row">
        <span class="breakdown-name">Logical Strength</span>
        <div class="breakdown-track"><div class="breakdown-fill fill-red" style="width:80%"></div></div>
        <span class="breakdown-score">8/10</span>
      </div>
      <div class="breakdown-row">
        <span class="breakdown-name">Clarity</span>
        <div class="breakdown-track"><div class="breakdown-fill fill-orange" style="width:65%"></div></div>
        <span class="breakdown-score">6.5/10</span>
      </div>
      <div class="breakdown-row">
        <span class="breakdown-name">Evidence Used</span>
        <div class="breakdown-track"><div class="breakdown-fill fill-purple" style="width:50%"></div></div>
        <span class="breakdown-score">5/10</span>
      </div>
      <div class="breakdown-row">
        <span class="breakdown-name">Recovered Well</span>
        <div class="breakdown-track"><div class="breakdown-fill fill-red" style="width:70%"></div></div>
        <span class="breakdown-score">7/10</span>
      </div>
    </div>

    <div class="fallacy-box">
      <div class="fallacy-title">‚ö†Ô∏è Fallacies Detected</div>
      <div class="fallacy-item">Confused inertia with free-fall (satellite example)</div>
      <div class="fallacy-item">Circular reasoning when defining "external force"</div>
      <div class="fallacy-item">Hasty generalization ‚Äî "friction always applies"</div>
    </div>

    <div style="font-size:11px;color:var(--muted);line-height:1.7">
      <span style="color:#f87171">Strength:</span> You recovered quickly when cornered on friction. Good instinct.<br>
      <span style="color:#f87171">Weakness:</span> Study real-world force-free scenarios and Newton's frame of reference more carefully.
    </div>
  </div>
</div>

<script>
const demoReplies = [
  "Interesting point ‚Äî but you're still not addressing the core contradiction. If a 'force-free' environment is purely theoretical, does that make Newton's First Law a mathematical abstraction rather than a physical law? <strong>Defend that position.</strong>",
  "You're retreating into definitions instead of engaging with the physics. A great batsman doesn't just block ‚Äî they drive. <strong>Give me a concrete physical example that supports your claim, not just a definition.</strong>",
  "That's more structured. But your logic still has a gap ‚Äî you've proven what inertia isn't, not what it is. <strong>Can you define inertia WITHOUT using Newton's own words?</strong>",
];

let replyIndex = 0;
let isRecording = false;

function autoResize(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 100) + 'px';
}

function handleKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
}

function sendMessage() {
  const input = document.getElementById('userInput');
  const text = input.value.trim();
  if (!text) return;

  addMessage('user', text);
  input.value = '';
  input.style.height = 'auto';

  showTyping();
  setTimeout(() => {
    hideTyping();
    const reply = demoReplies[replyIndex % demoReplies.length];
    replyIndex++;
    addAIMessage(reply);
  }, 1800);
}

function addMessage(role, text) {
  const messages = document.getElementById('messages');
  const div = document.createElement('div');
  div.className = `msg ${role}`;
  const avatar = role === 'user'
    ? '<div class="avatar user-av">A</div>'
    : '<div class="avatar ai-av">üî•</div>';
  const bubble = `<div class="bubble">${text}</div>`;
  div.innerHTML = role === 'user'
    ? `${avatar}<div>${bubble}</div>`
    : `${avatar}<div>${bubble}</div>`;
  messages.insertBefore(div, document.getElementById('typing-row'));
  messages.scrollTop = messages.scrollHeight;
}

function addAIMessage(html) {
  const messages = document.getElementById('messages');
  const div = document.createElement('div');
  div.className = 'msg ai';
  div.innerHTML = `<div class="avatar ai-av">üî•</div><div><div class="bubble">${html}</div></div>`;
  messages.insertBefore(div, document.getElementById('typing-row'));
  messages.scrollTop = messages.scrollHeight;
}

function showTyping() {
  document.getElementById('typing-row').style.display = 'flex';
  const messages = document.getElementById('messages');
  messages.scrollTop = messages.scrollHeight;
}

function hideTyping() {
  document.getElementById('typing-row').style.display = 'none';
}

function toggleMic() {
  const btn = document.getElementById('micBtn');
  isRecording = !isRecording;
  btn.classList.toggle('recording', isRecording);
  btn.textContent = isRecording ? 'üî¥' : 'üéôÔ∏è';
  if (isRecording) {
    setTimeout(() => {
      btn.classList.remove('recording');
      btn.textContent = 'üéôÔ∏è';
      isRecording = false;
      document.getElementById('userInput').value = 'A force-free object would exist in deep intergalactic space, far from any mass.';
      autoResize(document.getElementById('userInput'));
    }, 2500);
  }
}

function showModal() {
  document.getElementById('modal').classList.remove('hidden');
}

function closeModal() {
  document.getElementById('modal').classList.add('hidden');
}

document.getElementById('modal').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});
</script>
</body>
</html>

